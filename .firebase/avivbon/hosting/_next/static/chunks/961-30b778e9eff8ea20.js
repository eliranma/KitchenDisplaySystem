(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[961],{2961:function(e,t,r){Promise.resolve().then(r.bind(r,8136)),Promise.resolve().then(r.bind(r,4480)),Promise.resolve().then(r.bind(r,9091)),Promise.resolve().then(r.bind(r,5514))},8136:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return g}});var l=r(5713),s=r(8626),n=r(4475),i=r(608);r(2105);var o=r(9325),a=r.n(o);let c=[{name:"Tbl",node:{src:"/_next/static/media/tbl.9c81941b.svg",height:64,width:64,blurWidth:0,blurHeight:0}},{name:"TA",node:{src:"/_next/static/media/take-away.927aab80.svg",height:64,width:64,blurWidth:0,blurHeight:0}},{name:"Delivery",node:{src:"/_next/static/media/delivery.b7527e5a.svg",height:64,width:64,blurWidth:0,blurHeight:0}}];var d=e=>{let{id:t,queueId:r,docPayTypeName:s,total:n,tblNo:i,tmOpen:o,servingId:d}=e;return(0,l.jsxs)("div",{className:"bg-white z-50 shadow-md flex flex-col items-start rounded-lg p-2 ",children:[(0,l.jsxs)("div",{className:" flex flex-row items-center ",children:[(0,l.jsx)("h2",{className:"text-xs md:text-md md:text-lg font-semibold",children:i>0?"שולחן  ".concat(i):"הזמנה : ".concat(r)}),(0,l.jsx)(a(),{className:"mx-3",src:c[d].node,alt:c[d].name,width:24,height:24}),!1]}),(0,l.jsxs)("p",{className:"p-0 text-xs md:text-md md:text-lg font-semibold ",children:["מועד הזמנה : ",new Date(o).toLocaleString("he-IL").replace(",","")]}),(0,l.jsx)("div",{className:"border-t border-gray-200"})]})},u=r(124),h=r.n(u);r(5790);var x=r(7710).lW,f=e=>{let{onClose:t,file:r}=e,n=(0,s.useMemo)(()=>(0,l.jsx)(a(),{src:"data:image/jpeg;base64, ".concat(x.from(r.data).toString("base64")),width:.355*window.innerWidth,height:50,alt:"bon"}),[r.data]);return(0,l.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,l.jsx)("div",{className:"fixed flex inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t}),(0,l.jsxs)("div",{className:"relative h-auto w-full xs:max-w-[50vw] sm:max-w-[50vw] mx-auto p-4  bg-white rounded-lg shadow-xl",children:[(0,l.jsx)("div",{className:"flex flex-wrap overflow-y-auto items-center justify-center  max-h-[65vh] ",children:(0,l.jsx)("div",{className:" flex justify-center items-center w-full py-5 ",children:n})}),(0,l.jsx)("div",{className:"bg-gray-50 flex justify-center items-center px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6",children:(0,l.jsx)("button",{type:"button",className:"inline-flex w-full items-center justify-center rounded-full bg-red-600 px-12 py-1 text-sm font-semibold text-white shadow-sm hover:bg-red-500 sm:ml-3 sm:w-auto",onClick:t,children:(0,l.jsx)("p",{className:"text-center",children:"סגור"})})})]})]})},m=r(7710).lW,g=e=>{var t;let{id:r,bon:o}=e,c=(0,s.useRef)(null),[u,x]=(0,s.useState)(!1),[g,v]=(0,s.useState)(20),{data:p,setData:w}=(0,i.b)(),b=async()=>{if(o._id&&p.session)try{w(e=>({...e,autoRefresh:!1}));let e=await h().updateOrderStatus(o._id,p.session);if(!0===e){let e=[...p.orders];e.splice(r,1),w(t=>({...t,orders:e,autoRefresh:!0}));return}}catch(e){console.log(e)}},{queueId:j,docPayTypeName:y,total:N,tblNo:k,tmOpen:S,servingId:C,prnName:E,items:R,file:_}=o;(0,s.useEffect)(()=>{v(c.current.offsetHeight-150)},[null==c?void 0:null===(t=c.current)||void 0===t?void 0:t.offsetHeight]);let T=(0,s.useMemo)(()=>(0,l.jsx)(a(),{alt:"BON",src:"data:image/jpeg;base64, ".concat(m.from(_.data).toString("base64")),width:window.innerWidth,height:20}),[_]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{dir:"rtl",ref:c,className:"flex flex-col p-4 h-full  relative",children:[(0,l.jsx)(d,{id:r,tmOpen:S,tblNo:k,servingId:C,queueId:j}),(0,l.jsx)("div",{className:"flex border rounded-lg my-1",children:(0,l.jsx)("div",{style:{height:g},className:"w-full  flex flex-wrap justify-center items-start mt-2 overflow-y-auto overflow-x-hidden bg-white",onClick:()=>{console.log("CLICKED"),x(e=>!e)},children:T})}),(0,l.jsx)("button",{onClick:()=>{let e=p.session;return b(o._id,e)},className:"rounded-full mx-auto absolute bottom-1.5 mt-1 left-1/2 transform -translate-x-1/2 px-12 py-1 w-auto text-white bg-[#e4004a]",children:"בוצע"})]}),u&&(0,n.createPortal)((0,l.jsx)(f,{file:_,onClose:()=>{x(!1)}}),window.document.body)]})}},9091:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return h}});var l=r(5713),s=r(5965),n=r(8626);r(5056),r(1031);var i=r(8136);let o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,r=[],l=Array(t).fill(0);for(let s=0;s<e;s++){let e=s%t,n=2===t?2:3;r.push({i:s.toString(),x:e,y:l[e],w:1,h:n,static:!1,minH:2}),l[e]+=n}return r};var a=r(2105),c=r.n(a),d=r(8813),u=r(608),h=e=>{var t;let{orders:r=[]}=e,{data:a}=(0,u.b)(),{layout:h,setLayout:x,layoutDraggable:f}=(0,d.l)(),m=c()()?2:4,g=null===(t=globalThis.window)||void 0===t?void 0:t.innerWidth;return(0,n.useEffect)(()=>{let e=null==a?void 0:a.orders.length;if(e>0&&e!==h.length){let t=o(e,m);console.log(t),x(t)}else console.log("Nothing to change!")},[null==a?void 0:a.orders]),(0,l.jsx)("div",{className:"overflow-x-hidden",children:(0,l.jsx)(s.Responsive,{className:"layout",compactType:"vertical",style:{paddingTop:5},breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:4,md:4,sm:2,xs:2,xxs:2},layouts:{lg:h},margin:[15,20],isDraggable:f,onLayoutChange:e=>x(e),width:g,children:null==a?void 0:a.orders.map((e,t)=>(0,l.jsx)("div",{className:" rounded-lg shadow-md bg-white",children:(0,l.jsx)(i.default,{bon:e,id:t})},t))})})}},4480:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var l=r(5713),s=r(8626),n=r(1343),i=r(124),o=r.n(i),a=r(608),c=e=>{let{username:t=null,password:r=null}=e,i=(0,n.useRouter)(),[c,d]=(0,s.useState)(""),{setData:u}=(0,a.b)(),[h,x]=(0,s.useState)(""),[f,m]=(0,s.useState)(""),[g,v]=(0,s.useState)(!0);(0,s.useEffect)(()=>{console.log(t,r),t&&r&&p()},[]);let p=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r;if(!e||!l)return;let s=await o().login(e,l);s?(console.log("login result: ",s),g&&localStorage.setItem("session",JSON.stringify(s)),u(e=>({...e,session:s,isRememberMe:g})),setTimeout(()=>{i.push("/orders",{prefetch:!1})},500)):d("Login failed. Please check your credentials.")};return(0,l.jsx)("div",{dir:"rtl",className:"flex items-center justify-center min-h-screen bg-gray-100",children:(0,l.jsxs)("div",{className:"bg-white p-8 rounded shadow-md w-full max-w-md",children:[(0,l.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"התחברות"}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{htmlFor:"username",className:"block mb-1 font-medium",children:"שם משתמש"}),(0,l.jsx)("input",{type:"text",id:"username",value:h,className:"w-full border rounded px-3 py-2",onChange:e=>x(e.target.value),placeholder:"הזן מזהה לקוח"})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{htmlFor:"password",className:"block mb-1 font-medium",children:"סיסמא"}),(0,l.jsx)("input",{type:"password",id:"password",value:f,onChange:e=>m(e.target.value),className:"w-full border rounded px-3 py-2",placeholder:"הזן מזהה מכשיר"})]}),(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsxs)("div",{className:"inline-flex items-center",children:[(0,l.jsxs)("label",{className:"relative flex cursor-pointer items-center rounded-full p-3",htmlFor:"checkbox-1","data-ripple-dark":"true",children:[(0,l.jsx)("input",{type:"checkbox",className:"before:content[''] peer relative h-5 w-5 cursor-pointer appearance-none rounded-md border border-blue-gray-200 transition-all before:absolute before:top-2/4 before:left-2/4 before:block before:h-12 before:w-12 before:-translate-y-2/4 before:-translate-x-2/4 before:rounded-full before:bg-blue-gray-500 before:opacity-0 before:transition-opacity checked:border-pink-500 checked:bg-pink-500 checked:before:bg-pink-500 hover:before:opacity-10",id:"checkbox-1",defaultChecked:!0,value:g,onChange:()=>v(e=>!e)}),(0,l.jsx)("div",{className:"pointer-events-none absolute top-2/4 left-2/4 -translate-y-2/4 -translate-x-2/4 text-white opacity-0 transition-opacity peer-checked:opacity-100",children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5",viewBox:"0 0 20 20",fill:"currentColor",stroke:"currentColor",strokeWidth:"1",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),(0,l.jsx)("p",{children:"שמור פרטי התחברות "})]}),(0,l.jsx)("button",{onClick:()=>p(h,f),className:"bg-pink-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-colors",children:"התחבר"})]}),c&&(0,l.jsx)("p",{className:"text-red-500 mt-2",children:c})]})]})})},d=()=>{let e,t;let r=(0,n.useSearchParams)();try{e=r.get("username"),t=r.get("password")}catch(r){e=null,t=null}return(0,l.jsxs)("div",{className:"flex-col  w-full h-full flex bg-slate-500",children:[(0,l.jsx)(c,{username:e,password:t}),";"]})}},5514:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return T}});var l=r(5713),s=r(9091),n=e=>{let{children:t}=e;return(0,l.jsx)("div",{className:"w-full h-full",children:t})},i=r(8626),o=r(608);let a=(e,t)=>e.sort((e,r)=>{let l=new Date(e.tmOpen),s=new Date(r.tmOpen);if("ASC"===t)return l-s;if("DESC"===t)return s-l;throw Error('Invalid sort order. Please use "ASC" or "DESC".')}),c=e=>[...e],d=e=>{let t=null;return e.forEach(e=>{let r=e._id;(!t||r>t)&&(t=r)}),t},u=()=>(0,l.jsxs)("svg",{className:"h-8 w-8 text-white",width:"24",height:"24",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:["  ",(0,l.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z"}),"  ",(0,l.jsx)("line",{x1:"4",y1:"6",x2:"11",y2:"6"}),"  ",(0,l.jsx)("line",{x1:"4",y1:"12",x2:"11",y2:"12"}),"  ",(0,l.jsx)("line",{x1:"4",y1:"18",x2:"13",y2:"18"}),"  ",(0,l.jsx)("polyline",{points:"15 9 18 6 21 9"}),"  ",(0,l.jsx)("line",{x1:"18",y1:"6",x2:"18",y2:"18"})]}),h=()=>(0,l.jsxs)("svg",{className:"h-8 w-8 text-white",width:"24",height:"24",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:["  ",(0,l.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z"}),"  ",(0,l.jsx)("line",{x1:"4",y1:"6",x2:"13",y2:"6"}),"  ",(0,l.jsx)("line",{x1:"4",y1:"12",x2:"11",y2:"12"}),"  ",(0,l.jsx)("line",{x1:"4",y1:"18",x2:"11",y2:"18"}),"  ",(0,l.jsx)("polyline",{points:"15 15 18 18 21 15"}),"  ",(0,l.jsx)("line",{x1:"18",y1:"6",x2:"18",y2:"18"})]});var x=()=>{let{data:e,setData:t}=(0,o.b)();return(0,l.jsx)("div",{className:"w-max flex justify-center items-center",children:(0,l.jsxs)("button",{className:"flex flex-row px-2 bg-[#009610] rounded-full",onClick:()=>{let r=(null==e?void 0:e.sorted)==="DESC"?"ASC":"DESC";t(e=>({...e,sorted:r}));let l=a(e.orders,r);t(e=>({...e,orders:l}))},children:[(0,l.jsx)("p",{className:"whitespace-nowrap overflow-hidden text-white overflow-ellipsis mx-1",children:"מיון"}),(null==e?void 0:e.sorted)==="DESC"?u():h()]})})},f=()=>{let[e,t]=(0,i.useState)([{name:"הכל",_id:0}]),[r,s]=(0,i.useState)(void 0),{data:n,setData:a}=(0,o.b)();(0,i.useEffect)(()=>{n&&n.printers&&t([{name:"הכל",_id:0},...n.printers])},[n.printers]);let c=async t=>{let r=t.target.value;s(r);let l=e.find(e=>e.name===r);a(e=>({...e,printerSelected:l}))};return(0,l.jsx)("div",{className:"w-full bg-black flex items-center md:mr-28",children:(0,l.jsxs)("div",{className:"relative inline-block w-full text-left",children:[(0,l.jsx)("select",{value:r,onChange:c,className:"block appearance-none w-full bg-white border border-gray-400 hover:border-gray-500 px-4 py-2 pr-8 rounded shadow leading-tight focus:outline-none focus:shadow-outline",children:null==e?void 0:e.map(e=>(0,l.jsx)("option",{value:e.name||"",children:e.name||""},e._id))}),(0,l.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:(0,l.jsx)("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,l.jsx)("path",{d:"M5.293 9.293a1 1 0 011.414 0L10 12.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"})})})]})})},m=r(8813),g=()=>{let{layoutDraggable:e,setLayoutDraggable:t}=(0,m.l)(),r=()=>{t(e=>!e)};return(0,l.jsx)("div",{className:"flex justify-center w-max py-1 mr-1",children:e?(0,l.jsx)("button",{className:"flex items-center rounded-full px-5 bg-[#a70035]",onClick:()=>r(),children:(0,l.jsx)("p",{className:"whitespace-nowrap overflow-hidden text-white overflow-ellipsis",children:"שמור מיקום"})}):(0,l.jsx)("button",{className:"flex items-center rounded-full px-5 bg-[#009610]",onClick:()=>r(),children:(0,l.jsx)("p",{className:"whitespace-nowrap overflow-hidden text-white overflow-ellipsis",children:"שנה מיקום"})})})},v=()=>{let{data:e,setData:t}=(0,o.b)(),r=e.autoRefresh;return(0,l.jsx)("div",{className:"w-max flex items-center justify-center mx-1 rounded-full bg-[#00E318] p-1",children:(0,l.jsxs)("label",{className:"relative  inline-flex items-center justify-center cursor-pointer",children:[(0,l.jsx)("input",{value:r,checked:r,type:"checkbox",className:"sr-only peer",onChange:()=>t(e=>({...e,autoRefresh:!e.autoRefresh}))}),(0,l.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-pink-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-[#a70035]"}),(0,l.jsx)("p",{className:"whitespace-nowrap overflow-hidden  overflow-ellipsis mx-1",children:"רענון אוטומטי (10 ש')"})]})})},p=e=>{let{children:t}=e,[r,s]=(0,i.useState)(!1);return(0,l.jsxs)("div",{className:"relative text-left",children:[(0,l.jsx)("button",{onClick:()=>s(e=>!e),className:" text-white px-4 py-2 rounded",children:(0,l.jsx)("svg",{className:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})}),r&&(0,l.jsx)("div",{className:"absolute right-1 mt-1 w-56 rounded-md shadow-lg bg-white",children:(0,l.jsx)("div",{className:"rounded-md bg-slate-700 p-1 shadow-xs",children:(0,l.jsx)("div",{className:"py-1 flex flex-col items-end justify-evenly",children:t})})})]})},w=e=>{let{progress:t,height:r}=e;return console.log("progress:",t.toFixed(0)),(0,l.jsx)("div",{className:" py-10 px-5",style:{height:r},children:(0,l.jsxs)("div",{className:"flex flex-col mb-2 px-14 items-center justify-between",children:[(0,l.jsx)("div",{className:"flex justify-center items-center w-5/6",children:(0,l.jsx)("span",{className:"text-md font-semibold inline-block py-1 px-5 uppercase rounded-full text-teal-600 bg-teal-200",children:".... טוען הזמנות"})}),(0,l.jsx)("div",{className:"overflow-hidden w-full h-2 my-4 text-xs flex rounded bg-teal-200",children:(0,l.jsx)("div",{style:{width:"".concat(t.toFixed(0),"%"),transitionProperty:"all",transitionTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",transitionDuration:"150ms"},className:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-teal-500 "})}),(0,l.jsx)("div",{className:"text-right",children:(0,l.jsxs)("span",{className:"text-md font-semibold inline-block text-teal-600",children:[t.toFixed(0),"%"]})})]})})},b={src:"/_next/static/media/loading.476a71e4.gif",height:55,width:55,blurWidth:0,blurHeight:0},j=r(1343),y=r(124),N=r.n(y),k=r(2105),S=r.n(k),C=r(9325),E=r.n(C),R=r(5790);let _=(e,t)=>{let r;return function(){for(var l=arguments.length,s=Array(l),n=0;n<l;n++)s[n]=arguments[n];let i=this;clearTimeout(r),r=setTimeout(()=>e.apply(i,s),t)}};var T=()=>{var e,t,r;let a;let{data:u,setData:h}=(0,o.b)(),m=(0,j.useRouter)(),[y,k]=(0,i.useState)(0),[C,T]=(0,i.useState)(!1),[P,I]=(0,i.useState)(!1),[O,D]=(0,i.useState)(0),[L,A]=(0,i.useState)(!1),H=(0,i.useRef)(null),z=(0,i.useRef)(null),M=(0,i.useRef)(0),W=(0,i.useRef)(),F=u.session,B=(null===(t=globalThis)||void 0===t?void 0:null===(e=t.window)||void 0===e?void 0:e.innerHeight)-92||0,q=null==u?void 0:null===(r=u.printerSelected)||void 0===r?void 0:r.name;(0,i.useEffect)(()=>{W.current=u.orders},[u.orders]);let G=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20,s=await N().getOrders(e,t,r,l);null!==s&&((s=c(s)).length>0&&(M.current+=l,console.log("SET THE offsetRef to:".concat(M.current)),console.log("".concat(s.length))),h(e=>({...e,orders:s,sorted:"NONE",autoRefresh:!0})))},J=async function(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",l=[],s=[...W.current];if(s.map(e=>l.push(e._id)),0===l.length)return console.log("Due to currentId array is empty requesting ordersReq"),await G(e,r);let n=await N().checkExists(e,l);if(null!==n){l=(null==n?void 0:n.found)||l;let e=[...n.missing];t=d(s=[...s].filter(t=>!e.includes(t._id))),e!==[]&&h(e=>({...e,orders:s}))}let i=await N().askForNewOrders(e,t,r);if(i&&Array.isArray(i)&&i.length>0){let e=[...new Map([...i,...s].map(e=>[e._id,e])).values()];h(t=>({...t,orders:[...e]}))}},Z=async e=>{(a=await N().getPrinters(e))&&h(e=>({...e,printers:a}))},K=()=>{let e=localStorage.getItem("session");if((e=JSON.parse(e)).token)return e;throw Error("No session found local storage!")},Y=()=>{(null===W.current?[]:[...W.current]).length>0?A(!0):A(!1)},Q=e=>{k(e)};(0,i.useEffect)(()=>{var e;let t;try{u.session||(F=K(),h(e=>({...e,session:F})))}catch(e){m.push("/")}let r=async()=>{try{D(0),t=setInterval(()=>{D(e=>{var r;return e>=100||(null==u?void 0:null===(r=u.orders)||void 0===r?void 0:r.length)>0?(clearInterval(t),T(!1),100):Math.min(e+3,100)})},30),T(!0),console.log("Due initializtion process requesting ordersReq"),await G(F),await Z(F)}catch(e){console.error(e),clearInterval(t),D(0)}};return(null===(e=F)||void 0===e?void 0:e.token)&&r(),()=>{t&&clearInterval(t)}},[null==u?void 0:u.session]),(0,i.useEffect)(()=>{var e,t;if((null===(e=F)||void 0===e?void 0:e.token)&&(null==u?void 0:u.printers)){q="הכל"===(q=(null==u?void 0:null===(t=u.printerSelected)||void 0===t?void 0:t.name)||"")?"":q;try{T(!0),console.log("Due to changes in selectedPrinter requesting ordersReq"),G(F,q)}catch(e){console.log(e)}setTimeout(()=>T(!1),1e3)}},[null==u?void 0:u.printerSelected]),(0,i.useEffect)(()=>{var e;if(!(null===(e=F)||void 0===e?void 0:e.token))return clearTimeout(H.current);let t=async()=>{try{let e="הכל"===q?null:q;T(!0),await J(F,e),setTimeout(()=>T(!1),1e3),!0===u.autoRefresh&&(H.current=setTimeout(t,1e4))}catch(e){console.log(e)}};return!0===u.autoRefresh&&F?t():clearTimeout(H.current),()=>{clearTimeout(H.current)}},[null==u?void 0:u.autoRefresh,F,q]);let U=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,s=await N().getOrders(e,t,r,l),n=null===W.current?[]:[...W.current];if(s.length>0){let e=[...new Map([...n,...s].map(e=>[e._id,e])).values()];h(t=>({...t,orders:e})),M.current+=l,console.log("SET THE offsetRef to:".concat(M.current)),I(!1)}setTimeout(()=>h(e=>({...e,autoRefresh:!0})),1e3)},V=_(e=>{e.preventDefault();let t=e.target.scrollHeight-(e.target.scrollTop+e.target.clientHeight);t<=500&&!P&&(I(!0),h(e=>({...e,autoRefresh:!1})),U(F,q,M.current,20))},300);return(0,i.useEffect)(()=>(console.log(z.current),z.current&&z.current.addEventListener("scroll",V),()=>{z.current&&z.current.removeEventListener("scroll",V)}),[null==z?void 0:z.current]),(0,i.useEffect)(()=>{Y()},[W.current]),(0,i.useEffect)(()=>Q(B),[B]),(0,i.useEffect)(()=>console.log(M.current),[M.current]),(0,l.jsxs)(n,{children:[(0,l.jsxs)("div",{className:"sticky top-14 bg-white  z-50 flex h-9 flex-row",children:[(0,l.jsx)(f,{}),C?(0,l.jsx)(E(),{className:"p-1",src:b,loader:e=>{let{src:t}=e;return t},alt:"loading"}):(0,l.jsx)("span",{className:"w-[56px]"}),S()()?(0,l.jsxs)(p,{children:[(0,l.jsx)(v,{}),(0,l.jsxs)("div",{className:"flex flex-row items-center justify-around mt-1",children:[(0,l.jsx)(x,{}),(0,l.jsx)(g,{})]})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(x,{}),(0,l.jsx)(v,{}),(0,l.jsx)(g,{})]})]}),(0,l.jsx)("div",{ref:z,style:{overflowY:"auto",height:y},children:O<100?(0,l.jsx)(w,{progress:O}):(0,l.jsx)(l.Fragment,{children:L?(0,l.jsx)(s.default,{orders:W.current}):(0,l.jsx)(R.Z,{})})})]})}},5790:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var l=r(5713);r(8626);var s=r(9325),n=r.n(s),i={src:"/_next/static/media/no_Data.10e464fa.svg",height:500,width:500,blurWidth:0,blurHeight:0},o=()=>(0,l.jsx)("div",{className:"flex flex-col items-center py-10 justify-center h-full",children:(0,l.jsxs)("div",{className:" bg-[#E9F9EE] pt-3 flex items-center flex-col rounded-lg shadow-lg",children:[(0,l.jsx)("h1",{className:"text-xl text-gray-500 font-bold",children:" .... לא נמצאו הזמנות"}),(0,l.jsx)(n(),{className:"mt-4",src:i,alt:"No Data Image"})]})})},608:function(e,t,r){"use strict";r.d(t,{b:function(){return o},w:function(){return i}});var l=r(5713),s=r(8626);let n=(0,s.createContext)(),i=e=>{let{children:t}=e,[r,i]=(0,s.useState)({session:null,orders:null,printers:null,printerSelected:"הכל",isRememberMe:!0,sorted:"NONE",autoRefresh:!1});return(0,l.jsx)(n.Provider,{value:{data:r,setData:i},children:t})},o=()=>{let e=(0,s.useContext)(n);if(!e)throw Error("useAppContext must be used within an AppProvider");return e}},8813:function(e,t,r){"use strict";r.d(t,{a:function(){return i},l:function(){return o}});var l=r(5713),s=r(8626);let n=(0,s.createContext)(),i=e=>{let{children:t}=e,[r,i]=(0,s.useState)(!1),[o,a]=(0,s.useState)([]);return(0,l.jsx)(n.Provider,{value:{layoutDraggable:r,setLayoutDraggable:i,layout:o,setLayout:a},children:t})},o=()=>{let e=(0,s.useContext)(n);if(!e)throw Error("useLayoutContext must be used within an LayoutProvider");return e}},124:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let l=r(1801),s=l._(r(4221)),n="https://bonsrv.aviv-pos.co.il:6443";e.exports=new class{constructor(){this.login=async(e,t)=>{let r;return await s.default.post(n+"/kitchen/client/".concat(e,"/login"),{userId:t}).then(e=>r=200===e.status?e.data:null).catch(e=>(console.log(e),r=null,null)),r},this.askForNewOrders=async function(e,t){let r,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if((null==e?void 0:e.token)===void 0||(null==e?void 0:e.clientId)===void 0)return[];let i="Bearer "+e.token,o=e.clientId;return await s.default.post(n+"/kitchen/order/".concat(o,"/newOrders"),{order:t,printer:l},{headers:{Authorization:i}}).then(e=>{r=e.data}).catch(e=>{console.log(e),r=[]}),r},this.updateOrderStatus=async(e,t)=>{let r;let l="Bearer "+t.token,i=t.clientId,o="/kitchen/order/".concat(i,"/update/").concat(e);return await s.default.get(n+o,{headers:{Authorization:l}}).then(e=>r=200===e.status).catch(e=>(console.log(e),r=!1)),r},this.checkExists=async(e,t)=>{let r;let l="Bearer "+e.token,i=e.clientId;return await s.default.post(n+"/kitchen/order/".concat(i,"/validateExists"),{orders:t},{headers:{Authorization:l}}).then(e=>{r=200===e.status?e.data:null}).catch(e=>{console.log(e),r=null}),r},this.getOrders=async function(e,t){let r,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20,o="Bearer "+e.token,a=e.clientId,c=""===t?"/kitchen/order/".concat(a,"/getOrders/?offset=").concat(l,"&limit=").concat(i):"/kitchen/order/".concat(a,"/getOrders/").concat(t,"/?offset=").concat(l,"&limit=").concat(i);return await s.default.get(n+c,{headers:{Authorization:o}}).then(e=>r=e?e.data:[]).catch(e=>{console.log(e),r=[]}),r},this.getPrinters=async e=>{let t;let{clientId:r,token:l}=e;try{await s.default.get(n+"/kitchen/client/".concat(r,"/getPrinters"),{headers:{Authorization:"Bearer ".concat(l)}}).then(e=>(console.log("GetPrinters: ",e.data),(null==e?void 0:e.status)===200)?t=e.data:(console.log("GetPrinteres failed:",e.status),null))}catch(e){return console.log(e),null}return t}}}}}]);