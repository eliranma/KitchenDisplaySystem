(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[786],{6301:function(){},7274:function(){},2454:function(){},6812:function(){},1797:function(){},7442:function(e,t,r){Promise.resolve().then(r.bind(r,3226)),Promise.resolve().then(r.bind(r,5185)),Promise.resolve().then(r.bind(r,8863)),Promise.resolve().then(r.bind(r,7163))},5185:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return x}});var l=r(8274),s=r(6404),n=r(4716);r(3208);var o=e=>{let{dealId:t,docPayTypeName:r,total:n,tax:o,productCount:a,servingName:i}=e,[c,d]=(0,s.useState)(!1),u=()=>{console.log("clicked"),d(e=>!e)};return(0,l.jsxs)("div",{className:"bg-white z-50 shadow-md rounded-lg p-6 space-y-3",children:[(0,l.jsxs)("button",{onClick:()=>u(),children:[(0,l.jsxs)("h2",{className:"text-xs md:text-md md:text-lg font-semibold",children:["הזמנה: ",t]}),(0,l.jsx)("div",{className:"border-t border-gray-200"})]}),c&&(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-1",children:[(0,l.jsxs)("div",{dir:"rtl",className:"flex flex-row items-center ",children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"אמצעי תשלום"}),(0,l.jsx)("p",{className:"text-sm font-semibold",children:r}),(0,l.jsx)("p",{className:"text-sm mx-1 text-gray-500",children:" סה״כ "}),(0,l.jsxs)("p",{className:"text-sm font-semibold",children:[" ",n||0," ש״ח "]})]}),(0,l.jsxs)("div",{dir:"rtl",className:"flex flex-col",children:[(0,l.jsx)("p",{className:"text-sm font-semibold mx-1",children:i||"לשבת"}),(0,l.jsx)("p",{className:"text-sm text-gray-500 text-right mx-1",children:"מספר פריטים :  "}),(0,l.jsx)("p",{className:"text-sm font-semibold",children:a})]})]})]})},a=()=>(0,l.jsx)("div",{className:"flex items-center justify-center",children:(0,l.jsx)("p",{children:"NoData"})}),i=r(22),c=r(9615),d=r(3185),u=e=>{let{onClose:t,file:r}=e;return(0,l.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,l.jsx)("div",{className:"fixed flex inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t}),(0,l.jsxs)("div",{className:"relative h-auto w-full max-w-lg mx-auto p-4 bg-white rounded-lg shadow-xl",children:[(0,l.jsx)("div",{className:"flex items-center justify-center max-h-[40vh] overflow-y-auto",children:(0,l.jsx)(c.Z,{file:r,children:(0,l.jsx)(d.Z,{pageNumber:1,renderTextLayer:!1,renderAnnotationLayer:!1})})}),(0,l.jsx)("div",{className:"bg-gray-50 flex justify-center items-center px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6",children:(0,l.jsx)("button",{type:"button",className:"inline-flex w-full items-center justify-center rounded-full bg-red-600 px-12 py-1 text-sm font-semibold text-white shadow-sm hover:bg-red-500 sm:ml-3 sm:w-auto",onClick:t,children:(0,l.jsx)("p",{className:"text-center",children:"סגור"})})})]})]})},x=e=>{let{bon:t}=e,[x,h]=(0,s.useState)(),[f,m]=(0,s.useState)(1),[p,g]=(0,s.useState)(!1);console.log(t.pdfFile);let v=()=>{console.log("CLIECKED"),g(e=>!e)},{dealId:b,docPayTypeName:w,total:j,tax:y,productCount:N,servingName:k,prnId:S,prnName:C,items:E,pdfFile:P}=t;return i.default.GlobalWorkerOptions.workerSrc=new r.U(r(7653)).toString(),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{dir:"rtl",className:"flex flex-col p-4 relative rounded-lg shadow-md h-full bg-white",children:[(0,l.jsx)(o,{dealId:b}),(0,l.jsx)("div",{className:"flex border rounded-lg p-2 my-1",children:(0,l.jsx)("div",{className:" w-full flex justify-center items-center py-2",onClick:()=>v(),children:(0,l.jsx)(c.Z,{className:"flex items-center justify-center mx-1 h-full w-full",file:P,onLoadSuccess:e=>{let{numPages:t}=e;h(t)},noData:a,children:(0,l.jsx)(d.Z,{width:300,scale:.35,renderTextLayer:!1,renderAnnotationLayer:!1,pageNumber:f})})})}),(0,l.jsx)("button",{className:"rounded-full mx-3 absolute bottom-1.5 mt-1 left-1/2 transform -translate-x-1/2 px-12 py-1 w-auto text-white bg-[#e4004a]",children:"בוצע"})]}),p&&(0,n.createPortal)((0,l.jsx)(u,{file:P,onClose:()=>{g(!1)}}),window.document.body)]})}},3226:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return x}});var l=r(8274),s=r(789);r(2310),r(3806);var n=r(6404),o=r(5185);let a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=[];for(let l=0;l<e;l++){let e=Math.ceil(4*Math.random())+1,s=l%t;r.push({i:l.toString(),x:s,y:Math.floor(l/t)*e,w:1,h:2,static:!1})}return r};var i=r(22),c=r(7635),d=r(3208),u=r.n(d),x=e=>{var t;let{draggable:d=null}=e,x=u()()?2:4,{data:h}=(0,c.b)(),f=null===(t=globalThis.window)||void 0===t?void 0:t.innerWidth,[m,p]=(0,n.useState)([]);return i.default.GlobalWorkerOptions.workerSrc=new r.U(r(7653)).toString(),(0,n.useEffect)(()=>{var e;let t=a(null==h?void 0:null===(e=h.orders)||void 0===e?void 0:e.length,x);console.log(t),p(t)},[null==h?void 0:h.orders]),(0,l.jsx)("div",{className:" h-auto overflow-y-auto overflow-x-hidden",children:(0,l.jsx)(s.Responsive,{className:"layout",style:{paddingTop:5},breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:4,md:4,sm:2,xs:2,xxs:2},layouts:{lg:m},margin:[15,20],isDraggable:d,onLayoutChange:e=>p(e),width:f,children:(null==h?void 0:h.orders)?h.orders.map((e,t)=>(0,l.jsx)("div",{children:(0,l.jsx)(o.default,{bon:e})},t.toString())):null})})}},7163:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var l=r(8274),s=r(6404),n=r(2640),o=r(2935),a=r.n(o),i=r(7635),c=e=>{let{username:t=null,password:r=null}=e,o=(0,n.useRouter)(),[c,d]=(0,s.useState)(""),{setData:u}=(0,i.b)(),[x,h]=(0,s.useState)(""),[f,m]=(0,s.useState)(""),[p,g]=(0,s.useState)(!0);(0,s.useEffect)(()=>{console.log(t,r),t&&r&&v()},[]);let v=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r;if(!e||!l)return;let s=await a().login(e,l);s?(console.log("login result: ",s),p&&localStorage.setItem("session",JSON.stringify(s)),u(e=>({...e,session:s,isRememberMe:p})),o.push("/orders")):d("Login failed. Please check your credentials.")};return(0,l.jsx)("div",{dir:"rtl",className:"flex items-center justify-center min-h-screen bg-gray-100",children:(0,l.jsxs)("div",{className:"bg-white p-8 rounded shadow-md w-full max-w-md",children:[(0,l.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"התחברות"}),(0,l.jsxs)("form",{onSubmit:v,children:[(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{htmlFor:"username",className:"block mb-1 font-medium",children:"שם משתמש"}),(0,l.jsx)("input",{type:"text",id:"username",value:x,className:"w-full border rounded px-3 py-2",onChange:e=>h(e.target.value),placeholder:"הזן מזהה לקוח"})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{htmlFor:"password",className:"block mb-1 font-medium",children:"סיסמא"}),(0,l.jsx)("input",{type:"password",id:"password",value:f,onChange:e=>m(e.target.value),className:"w-full border rounded px-3 py-2",placeholder:"הזן מזהה מכשיר"})]}),(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsxs)("div",{className:"inline-flex items-center",children:[(0,l.jsxs)("label",{className:"relative flex cursor-pointer items-center rounded-full p-3",htmlFor:"checkbox-1","data-ripple-dark":"true",children:[(0,l.jsx)("input",{type:"checkbox",className:"before:content[''] peer relative h-5 w-5 cursor-pointer appearance-none rounded-md border border-blue-gray-200 transition-all before:absolute before:top-2/4 before:left-2/4 before:block before:h-12 before:w-12 before:-translate-y-2/4 before:-translate-x-2/4 before:rounded-full before:bg-blue-gray-500 before:opacity-0 before:transition-opacity checked:border-pink-500 checked:bg-pink-500 checked:before:bg-pink-500 hover:before:opacity-10",id:"checkbox-1",defaultChecked:!0,value:p,onChange:()=>g(e=>!e)}),(0,l.jsx)("div",{className:"pointer-events-none absolute top-2/4 left-2/4 -translate-y-2/4 -translate-x-2/4 text-white opacity-0 transition-opacity peer-checked:opacity-100",children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5",viewBox:"0 0 20 20",fill:"currentColor",stroke:"currentColor",strokeWidth:"1",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),(0,l.jsx)("p",{children:"שמור פרטי התחברות "})]}),(0,l.jsx)("button",{onClick:()=>v(x,f),className:"bg-pink-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-colors",children:"התחבר"})]}),c&&(0,l.jsx)("p",{className:"text-red-500 mt-2",children:c})]})]})})},d=()=>{let e,t;let r=(0,n.useSearchParams)();try{e=r.get("username"),t=r.get("password")}catch(r){e=null,t=null}return(0,l.jsx)("div",{className:"flex-col  w-full h-full flex bg-slate-500",children:(0,l.jsx)(c,{username:e,password:t})})}},8863:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return w}});var l=r(8274),s=r(3226),n=e=>{let{children:t}=e;return(0,l.jsx)("div",{className:"w-full h-full",children:t})},o=r(6404),a=r(7635);let i=(e,t)=>e.sort((e,r)=>{let l=new Date(e.tmOpen),s=new Date(r.tmOpen);if("ASC"===t)return l-s;if("DESC"===t)return s-l;throw Error('Invalid sort order. Please use "ASC" or "DESC".')}),c=()=>(0,l.jsxs)("svg",{className:"h-8 w-8 text-white",width:"24",height:"24",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:["  ",(0,l.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z"}),"  ",(0,l.jsx)("line",{x1:"4",y1:"6",x2:"11",y2:"6"}),"  ",(0,l.jsx)("line",{x1:"4",y1:"12",x2:"11",y2:"12"}),"  ",(0,l.jsx)("line",{x1:"4",y1:"18",x2:"13",y2:"18"}),"  ",(0,l.jsx)("polyline",{points:"15 9 18 6 21 9"}),"  ",(0,l.jsx)("line",{x1:"18",y1:"6",x2:"18",y2:"18"})]}),d=()=>(0,l.jsxs)("svg",{className:"h-8 w-8 text-white",width:"24",height:"24",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:["  ",(0,l.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z"}),"  ",(0,l.jsx)("line",{x1:"4",y1:"6",x2:"13",y2:"6"}),"  ",(0,l.jsx)("line",{x1:"4",y1:"12",x2:"11",y2:"12"}),"  ",(0,l.jsx)("line",{x1:"4",y1:"18",x2:"11",y2:"18"}),"  ",(0,l.jsx)("polyline",{points:"15 15 18 18 21 15"}),"  ",(0,l.jsx)("line",{x1:"18",y1:"6",x2:"18",y2:"18"})]});var u=()=>{let{data:e,setData:t}=(0,a.b)();return(0,l.jsx)("div",{className:"w-max flex justify-center items-center",children:(0,l.jsxs)("button",{className:"flex flex-row px-2 bg-green-300 rounded-full",onClick:()=>{let r=(null==e?void 0:e.sorted)==="DESC"?"ASC":"DESC";t(e=>({...e,sorted:r}));let l=i(e.orders,r);t(e=>({...e,orders:l}))},children:[(0,l.jsx)("p",{className:"whitespace-nowrap overflow-hidden text-white overflow-ellipsis mx-1",children:"מיון"}),(null==e?void 0:e.sorted)==="DESC"?c():d()]})})};let x=e=>e.hasOwnProperty("prnId")&&"number"==typeof e.prnId;var h=()=>{let[e,t]=(0,o.useState)([{name:"הכל",prnId:0}]),[r,s]=(0,o.useState)(void 0),{data:n,setData:i}=(0,a.b)();(0,o.useEffect)(()=>{if(console.log(n),n&&n.printers){let r=n.printers.filter(x).concat(e.filter(x));t(r)}},[n.printers]);let c=async t=>{let r=t.target.value;s(r);let l=e.find(e=>e.name===r);i(e=>({...e,printerSelected:l}))};return(0,l.jsx)("div",{className:"w-full bg-black flex items-center md:mr-28",children:(0,l.jsxs)("div",{className:"relative inline-block w-full text-left",children:[(0,l.jsx)("select",{value:r,onChange:c,className:"block appearance-none w-full bg-white border border-gray-400 hover:border-gray-500 px-4 py-2 pr-8 rounded shadow leading-tight focus:outline-none focus:shadow-outline",children:null==e?void 0:e.map(e=>(0,l.jsx)("option",{value:e.name||"",children:e.name||""},e.prnId))}),(0,l.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:(0,l.jsx)("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:(0,l.jsx)("path",{d:"M5.293 9.293a1 1 0 011.414 0L10 12.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"})})})]})})},f=e=>{let{action:t}=e,[r,s]=(0,o.useState)(!0),n=()=>{s(e=>!e),t(e=>!e)};return(0,l.jsx)("div",{className:"flex justify-center w-max py-1 mr-1",children:r?(0,l.jsx)("button",{className:"flex items-center rounded-full px-5 bg-emerald-400",onClick:()=>n(),children:(0,l.jsx)("p",{className:"whitespace-nowrap overflow-hidden text-white overflow-ellipsis",children:"שנה מיקום"})}):(0,l.jsx)("button",{className:"flex items-center rounded-full px-5 bg-[#a70035]",onClick:()=>n(),children:(0,l.jsx)("p",{className:"whitespace-nowrap overflow-hidden text-white overflow-ellipsis",children:"שמור מיקום"})})})},m=r(2935),p=r.n(m),g=e=>{let{timeInterval:t=10}=e,[r,s]=(0,o.useState)(!1),n=null,a=1e3*parseInt(t);return(0,o.useEffect)(()=>(!0===r?n=setInterval(()=>{console.log("10 sec refresh!")},a):!1===r&&clearInterval(n),()=>{clearInterval(n)}),[r]),(0,l.jsx)("div",{className:"w-max flex items-center justify-center mx-1 rounded-full bg-lime-200 px-1",children:(0,l.jsxs)("label",{className:"relative  inline-flex items-center justify-center cursor-pointer",children:[(0,l.jsx)("input",{value:r,type:"checkbox",className:"sr-only peer",onClick:()=>s(e=>!e)}),(0,l.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-pink-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-[#a70035]"}),(0,l.jsx)("p",{className:"whitespace-nowrap overflow-hidden  overflow-ellipsis mx-1",children:"רענון אוטומטי (10 ש')"})]})})},v=r(2640),b=r(4474),w=()=>{let e,t;let{data:r,setData:i}=(0,a.b)(),{layoutDraggable:c,setLayoutDraggable:d}=(0,b.l)(),x=(0,v.useRouter)(),m=r.session,w=async function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e=await p().getOrders(t,r),i(t=>({...t,orders:e,sorted:"NONE"}))},j=async e=>{t=await p().getPrinters(e),i(e=>({...e,printers:t}))},y=()=>{let e=localStorage.getItem("session");if(null==e?void 0:e.token)return e;throw Error("No session found local storage!")};return(0,o.useEffect)(()=>{if(!m){try{m=y(),console.log("Session found: ".concat(m)),i(e=>({...e,session:m}))}catch(e){console.log(e)}return x.push("/")}try{w(m),j(m)}catch(e){console.log(e)}},[m]),(0,o.useEffect)(()=>{var e;let t=(null==r?void 0:null===(e=r.printerSelected)||void 0===e?void 0:e.prnId)||0;try{w(m,t)}catch(e){console.log(e)}},[null==r?void 0:r.printerSelected]),(0,l.jsxs)(n,{children:[(0,l.jsxs)("div",{className:"sticky top-14 bg-white  z-50 flex h-9 flex-row",children:[(0,l.jsx)(h,{}),(0,l.jsx)(u,{}),(0,l.jsx)(g,{}),(0,l.jsx)(f,{action:d})]}),(0,l.jsx)(s.default,{draggable:c})]})}},7635:function(e,t,r){"use strict";r.d(t,{b:function(){return a},w:function(){return o}});var l=r(8274),s=r(6404);let n=(0,s.createContext)(),o=e=>{let{children:t}=e,[r,o]=(0,s.useState)({});return(0,l.jsx)(n.Provider,{value:{data:r,setData:o},children:t})},a=()=>{let e=(0,s.useContext)(n);if(!e)throw Error("useAppContext must be used within an AppProvider");return e}},4474:function(e,t,r){"use strict";r.d(t,{a:function(){return o},l:function(){return a}});var l=r(8274),s=r(6404);let n=(0,s.createContext)(),o=e=>{let{children:t}=e,[r,o]=(0,s.useState)(!1);return(0,l.jsx)(n.Provider,{value:{layoutDraggable:r,setLayoutDraggable:o},children:t})},a=()=>{let e=(0,s.useContext)(n);if(!e)throw Error("useLayoutContext must be used within an LayoutProvider");return e}},2935:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let l=r(1400),s=l._(r(6362)),n="https://bonsrv.aviv-pos.co.il:6006";e.exports=new class{constructor(){this.login=async(e,t)=>{let r;let l=n+"/kitchen/client/".concat(e,"/login");return console.log(l),await s.default.post(l,{userId:t}).then(e=>{200===e.status&&(r=e.data)}).catch(e=>(console.log(e),null)),r},this.getOrders=async(e,t)=>{let r;let l="Bearer "+e.token,o=e.clientId,a="/kitchen/order/".concat(o,"/getOrders/").concat(t);return await s.default.get(n+a,{headers:{Authorization:l}}).then(e=>(console.log(e.data),r=e?e.data:e)).catch(e=>(console.log(e),[])),r},this.getPrinters=async e=>{let t;let{clientId:r,token:l}=e;try{await s.default.get(n+"/kitchen/client/".concat(r,"/getPrinters"),{headers:{Authorization:"Bearer ".concat(l)}}).then(e=>(console.log("GetPrinters: ",e.data),(null==e?void 0:e.status)===200)?t=e.data:(console.log("GetPrinteres failed:",e.status),null))}catch(e){return console.log(e),null}return t}}}}}]);